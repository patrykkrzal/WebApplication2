<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="utf-8" />
    <title>Dane użytkownika</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="/css/site.css" rel="stylesheet">
</head>

<body>
    <div class="buttons-top-right">
        <button class="winter-button" type="button" data-nav="Index.html">❆ Menu</button>
        <button class="winter-button" type="button" data-nav="Equipment.html">⛷️ Sprzęt</button>
        <details class="user-panel disabled">
            <summary class="winter-button" aria-label="Panel użytkownika">👤 Panel użytkownika</summary>
            <div class="user-panel-menu">
                <button class="winter-button" type="button" data-nav="OrderHistory.html" data-show-when-auth="true">Historia
                    zamówień</button>
                <button class="winter-button" type="button" data-nav="UserData.html" data-show-when-auth="true">Dane
                    użytkownika</button>
                <button class="winter-button" type="button" data-nav="WorkerPanel.html"
                    data-required-roles="worker, administrator">Panel pracownika</button>
                <button class="winter-button" type="button" data-nav="AdminPanel.html"
                    data-required-roles="administrator">Panel administratora</button>
                <button class="winter-button" type="button" data-logout="true" data-show-when-auth="true">Wyloguj</button>
            </div>
        </details>
        <button class="winter-button" type="button" data-nav="Kontakt.html">📞 Kontakt</button>
        <button class="winter-button" type="button" data-nav="Basket.html">🧺 Koszyk</button>
        <button class="winter-button" type="button" data-nav="Login.html" data-hide-when-auth="true">🔒 Logowanie</button>
    </div>

    <div class="content-section">
        <div class="frost-effect">
            <h1 class="winter-title">Dane użytkownika</h1>

            <div id="userData" class="contact-info" data-show-when-auth="true">
                <p>Ładowanie danych...</p>
            </div>

            <div class="alt-link" data-hide-when-auth="true">
                Aby zobaczyć dane, zaloguj się: <a href="Login.html">Logowanie</a>
            </div>
        </div>
    </div>

    <script src="/js/site.js" defer></script>
    <script>
        async function loadUser() {
            try {
                let res = await fetch('/api/auth/me', { credentials: 'include' });
                if (!res.ok) { res = await fetch('/api/users/me', { credentials: 'include' }); }
                if (!res.ok) return;
                const u = await res.json();
                const el = document.getElementById('userData');
                const userName = u.userName ?? u.UserName ?? '—';
                const email = u.email ?? u.Email ?? '—';
                const phone = u.phoneNumber ?? u.PhoneNumber ?? '—';
                const firstName = u.first_name ?? u.First_name ?? '—';
                const lastName = u.last_name ?? u.Last_name ?? '—';

                el.innerHTML = `
<div class="contact-item"><strong>Nazwa użytkownika</strong><div class="contact-value">${userName}</div></div>
<div class="contact-item"><strong>Email</strong><div class="contact-value">${email}</div></div>
<div class="contact-item"><strong>Telefon</strong><div class="contact-value">${phone}</div></div>
<div class="contact-item"><strong>Imię</strong><div class="contact-value">${firstName}</div></div>
<div class="contact-item"><strong>Nazwisko</strong><div class="contact-value">${lastName}</div></div>`;
            } catch { }
        }
        document.addEventListener('DOMContentLoaded', loadUser);
    </script>
</body>

</html>