<!DOCTYPE html>
<html lang="pl">
<head>
 <meta charset="UTF-8" />
 <title>Rejestracja</title>
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <style>
 body { font-family: Arial, sans-serif; margin:2rem; }
 form { border:1px solid #ddd; padding:1rem; margin-bottom:2rem; max-width:480px; }
 label { display: block; margin-top: .5rem; }
 input { width:100%; padding: .5rem; margin-top: .25rem; }
 button { margin-top:1rem; padding: .5rem1rem; }
 .msg { margin-top: .5rem; white-space: pre-wrap; }
 .success { color: #0c7a0c; }
 .error { color: #b00020; }
 </style>
</head>
<body>
 <h1>Rejestracja</h1>
 <form id="registerForm">
 <label>Login (UserName)
 <input type="text" name="UserName" required />
 </label>
 <label>Email
 <input type="email" name="Email" required />
 </label>
 <label>Hasło
 <input type="password" name="Password" required />
 </label>
 <label>Imię
 <input type="text" name="FirstName" required />
 </label>
 <label>Nazwisko
 <input type="text" name="LastName" required />
 </label>
 <label>Telefon (ContactNumber)
 <input type="text" name="ContactNumber" required />
 </label>
 <label>Alias Login (opcjonalnie)
 <input type="text" name="Login" />
 </label>
 <label>Rola (opcjonalnie)
 <input type="text" name="Role" />
 </label>
 <button type="submit">Zarejestruj</button>
 <div id="registerMsg" class="msg"></div>
 </form>

 <script>
 const apiBase = '';
 function formToObject(form) {
 const obj = {};
 new FormData(form).forEach((v, k) => { obj[k] = v });
 Object.keys(obj).forEach(k => { if (obj[k] === '') delete obj[k]; });
 return obj;
 }
 async function postJson(url, body) {
 const res = await fetch(url, {
 method: 'POST',
 headers: { 'Content-Type': 'application/json' },
 body: JSON.stringify(body),
 credentials: 'include'
 });
 let text = await res.text();
 try { text = JSON.parse(text); } catch { }
 if (!res.ok) {
 throw (typeof text === 'string' ? new Error(text) : new Error(JSON.stringify(text)));
 }
 return text;
 }
 document.getElementById('registerForm').addEventListener('submit', async (e) => {
 e.preventDefault();
 const msg = document.getElementById('registerMsg');
 msg.className = 'msg';
 msg.textContent = 'Rejestracja...';
 const data = formToObject(e.target);
 try {
 await postJson(`${apiBase}/api/Register`, data);
 msg.className = 'msg success';
 msg.textContent = 'Rejestracja pomyślna';
 alert('Rejestracja zakończona sukcesem');
 } catch (err) {
 msg.className = 'msg error';
 msg.textContent = 'Błąd: ' + err.message;
 alert('Błąd rejestracji: ' + err.message);
 }
 });
 </script>
</body>
</html>
