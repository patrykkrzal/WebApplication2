<!DOCTYPE html>
<html lang="pl">
<head>
 <meta charset="utf-8" />
 <title>Sprzęt</title>
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
 <link href="/css/site.css" rel="stylesheet">
</head>
<body>
 <div class="buttons-top-right">
 <button class="winter-button" type="button" data-nav="Index.html">❆ Menu</button>
 <button class="winter-button" type="button" data-nav="Equipment.html">⛷️ Sprzęt</button>
 <details class="user-panel disabled">
 <summary class="winter-button" aria-label="Panel użytkownika">👤 Panel użytkownika</summary>
 <div class="user-panel-menu">
 <button class="winter-button" type="button" data-nav="OrderHistory.html" data-show-when-auth="true">Historia zamówień</button>
 <button class="winter-button" type="button" data-nav="UserData.html" data-show-when-auth="true">Dane użytkownika</button>
 <button class="winter-button" type="button" data-nav="WorkerPanel.html" data-required-roles="worker, administrator">Panel pracownika</button>
 <button class="winter-button" type="button" data-nav="AdminPanel.html" data-required-roles="administrator">Panel administratora</button>
 </div>
 </details>
 <button class="winter-button" type="button" data-nav="Kontakt.html">📞 Kontakt</button>
 <button class="winter-button" type="button" data-nav="Basket.html">🧺 Koszyk</button>
 <button class="winter-button" type="button" data-nav="Login.html" data-hide-when-auth="true">🔒 Logowanie</button>
 <button class="winter-button" type="button" data-logout="true" data-show-when-auth="true">🚪 Wyloguj</button>
 </div>

 <div class="content-section">
 <div class="frost-effect">
 <h1 class="winter-title">Sprzęt</h1>

 <!-- Slider sprzętu -->
 <div class="equipment-slider">
 <button class="winter-button slider-nav" id="prevSlide">◀</button>
 <div class="slide-viewport">
 <div class="slide-track" id="slideTrack">
 <!-- slides injected by script -->
 </div>
 </div>
 <button class="winter-button slider-nav" id="nextSlide">▶</button>
 </div>

 <!-- Lista (placeholder) -->
 <div id="equipmentList" class="mt-3"></div>
 </div>
 </div>

 <script src="/js/site.js" defer></script>
 <script>
 const equipmentSlides = [
 { type: 'Snowbard', img: '/Images/snowboard-113784.jpg' },
 { type: 'Gloves', img: '/Images/ski-glove-6933354.jpg' },
 { type: 'Poles', img: '/Images/ski-poles-252250.jpg' },
 { type: 'Helmet', img: '/Images/helmet-5992804.jpg' },
 { type: 'Skis', img: '/Images/ski-999705.jpg' },
 { type: 'Googles', img: '/Images/googles-2093046.jpg' }
 ];

 function buildSlides(){
 const track = document.getElementById('slideTrack');
 track.innerHTML = '';
 equipmentSlides.forEach((s) => {
 const slide = document.createElement('div');
 slide.className = 'slide';
 slide.innerHTML = `
 <img src="${s.img}" alt="${s.type}">
 <div class="slide-caption">${s.type}</div>
 `;
 track.appendChild(slide);
 });
 }

 // centerIndex = indeks slajdu, który ma być na środku (drugi z trzech widocznych)
 let centerIndex =1; // start pokazując drugi element jako największy

 function clampCenter(idx){
 const min =1; // aby był lewy sąsiad
 const max = equipmentSlides.length -2; // aby był prawy sąsiad
 if(idx < min) return min;
 if(idx > max) return max;
 return idx;
 }

 function markActive(){
 const slides = document.querySelectorAll('.slide');
 slides.forEach(s => { s.classList.remove('active','neighbor'); });
 if(slides.length===0) return;
 const left = centerIndex -1;
 const right = centerIndex +1;
 slides[centerIndex].classList.add('active');
 if(left >=0) slides[left].classList.add('neighbor');
 if(right < slides.length) slides[right].classList.add('neighbor');
 }

 function updateSlider(){
 const track = document.getElementById('slideTrack');
 // Przesuń tak, aby centerIndex był na środkowej pozycji (drugi z trzech)
 const offset = -(centerIndex -1) *33.3333;
 track.style.transform = `translateX(${offset}%)`;
 markActive();
 // Wyłącz przyciski na końcach
 document.getElementById('prevSlide').disabled = (centerIndex ===1);
 document.getElementById('nextSlide').disabled = (centerIndex === equipmentSlides.length -2);
 }

 function initSlider(){
 buildSlides();
 updateSlider();
 document.getElementById('prevSlide').onclick = ()=>{ centerIndex = clampCenter(centerIndex -1); updateSlider(); };
 document.getElementById('nextSlide').onclick = ()=>{ centerIndex = clampCenter(centerIndex +1); updateSlider(); };
 }

 document.addEventListener('DOMContentLoaded', initSlider);

 async function loadEquipment(){
 try{
 const res = await fetch('/api/equipment', { credentials: 'include' });
 if(!res.ok) return;
 const items = await res.json();
 const el = document.getElementById('equipmentList');
 if(Array.isArray(items) && items.length){
 el.innerHTML = '<ul>' + items.map(e => `<li>${(e.type||e.Type)||'Sprzęt'} — rozmiar ${(e.size||e.Size)||''} — ${e.price||e.Price} zł</li>`).join('') + '</ul>';
 } else {
 el.textContent = 'Brak sprzętu do wyświetlenia.';
 }
 }catch{}
 }
 loadEquipment();
 </script>
</body>
</html>